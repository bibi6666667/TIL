



## jasypt (μλ°” ν‚¤ μ•”νΈν™” λ°©μ‹)

> μ¶μ² : μ°λ””κ°€ κ³µμ ν•΄μ£Όμ‹  ν•„κΈ°λ…ΈνΈπ™‡β€β™‚οΈ

### Jasypt

- Java Simplified Encryption
- μλ°” μ½”λ“ μ•”νΈν™” μ„λΉ„μ¤ μ κ³µ 
- DB ν¨μ¤μ›λ“, OAuth Client Secret λ“± λ―Όκ°μ •λ³΄λ¥Ό μ•”νΈν™”ν•κΈ° μ„ν•΄ μ‚¬μ©ν•λ‹¤.

### Jasypt μ‚¬μ©ν•κΈ°

#### 1. μμ΅΄μ„± μ¶”κ°€

`build.gradle` μ— μ•„λ μ½”λ“ μ¶”κ°€

```
compile 'com.github.ulisesbocchio:jasypt-spring-boot-starter:3.0.3'
```

#### 2. λΉ„λ°€λ²νΈ μ•”νΈν™”

https://www.devglan.com/online-tools/jasypt-online-encryption-decryption μ—μ„ μ•”νΈν™”ν•κ³  μ‹¶μ€ μ½”λ“μ μ•”νΈν™”λ¥Ό μ§„ν–‰

[Jasypt Online Encryption] μμ—­μΌλ΅ μ¤ν¬λ΅¤ ν›„

- Enter plain text to Encrypt : μ•”νΈν™”ν•  μ½”λ“ μ…λ ¥
- Select Type of Encryption : μ•”νΈν™”ν•  λ°©μ‹ μ„ νƒ - Two wayλ΅ μ„ νƒ. λ””ν΄νΈ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ€ `PBEWithMD5AndDES`μ΄λ‹¤.
- Secret Key to Be Used While ... : μ•”νΈν™”μ— μ‚¬μ©ν•  μ‹ν¬λ¦Ώ ν‚¤ μ…λ ¥. (μ„μμ λ¬Έμμ—΄ λλ” μλ―Έμλ” λ‹¨μ–΄. λΉ„λ°€λ²νΈ κ°™μ€ κ°λ…)
- [Encrypt]λ¥Ό λ„λ¥΄λ©΄ μ•”νΈν™”κ°€ μ™„λ£λ λ¬Έμμ—΄μ΄ μ•„λ Encrypted Stringμ— μ¶λ ¥λλ‹¤.

#### 3. λ―Όκ°μ •λ³΄λ¥Ό μ•”νΈν™”λ μ½”λ“λ΅ λ³€κ²½

μ•”νΈν™”ν•κΈ° μ „ μ½”λ“λ¥Ό `ENC(μ•”νΈν™”ν• μ½”λ“)`λ΅ λ΅ μΉν™ν• λ’¤, 2.μ—μ„ μ…λ ¥ν• μ‹ν¬λ¦Ώ ν‚¤λ¥Ό μ„¤μ •ν•΄ μ¤€λ‹¤.

`application.properties`

```
github.client.secrets=ENC(OQLcoaTQsAdvyxldhkju7xBUa2c8cpTgIKSgM8SipRRMsr7cLHnrwu36AKEZTgTSoE014OG84eo=)
jasypt.encryptor.password=${JASYPT_PASSWORD}
```

- `${JASYPT_PASSWORD}` : μ•”νΈν™”μ— μ‚¬μ©ν• μ‹ν¬λ¦Ών‚¤λ¥Ό μΈν…”λ¦¬μ μ΄ ν™κ²½λ³€μλ΅ λ“±λ΅ ([μ°Έκ³ ](https://bibi6666667.tistory.com/314))

#### 4. Jasypt Configuration ν΄λμ¤ μ¶”κ°€ λ° Bean μ„¤μ •

```java
import org.jasypt.encryption.StringEncryptor;
import org.jasypt.encryption.pbe.PooledPBEStringEncryptor;
import org.jasypt.encryption.pbe.config.SimpleStringPBEConfig;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;

@Configuration
@PropertySource("application.properties")
public class JasyptConfig {

    @Value("${jasypt.encryptor.password}") // μ‹ν¬λ¦Ώ ν‚¤ 
    private String encryptKey;

    @Bean("jasyptStringEncryptor")
    public StringEncryptor stringEncryptor() {
        PooledPBEStringEncryptor encryptor = new PooledPBEStringEncryptor();
        SimpleStringPBEConfig config = new SimpleStringPBEConfig();
        config.setPassword(encryptKey);
        config.setAlgorithm("PBEWithMD5AndDES");
        config.setKeyObtentionIterations("1000");
        config.setPoolSize("1");
        config.setSaltGeneratorClassName("org.jasypt.salt.RandomSaltGenerator");
        config.setStringOutputType("base64");
        encryptor.setConfig(config);
        return encryptor;
    }

}
```

Two Way Encryption(PBEWithMD5AndDES)μΌλ΅ μ•”νΈν™”λ¥Ό μ§„ν–‰ν•λ” ν΄λμ¤.

- `${jasypt.encryptor.password}`λ΅ κ°€μ Έμ¨ `enctryptKey` λ³€μ(=μ‹ν¬λ¦Ών‚¤)λ¥Ό  κ°€μ Έμ΄
- `setPassword()`μ μΈμλ΅ μ‹ν¬λ¦Ών‚¤λ¥Ό μ„¤μ •
- `setAlgorithm("PBEWithMD5AndDES")` μΌλ΅ μ•”νΈν™” νƒ€μ… μ„¤μ •

μ„ ν΄λμ¤λ¥Ό μ¶”κ°€ ν›„, μ•„λ μ½”λ“λ¥Ό `application.properties`μ— μ¶”κ°€ν•΄ `JasyptStringEncryptor`λ¥Ό BeanμΌλ΅ λ“±λ΅ν•λ‹¤.

- `application.properties`

  ```
  #jaspyt config
  jasypt.encryptor.bean=jasyptStringEncryptor
  ```

#### 5. @EnableEncryptableProperties μ¶”κ°€

ν”„λ΅μ νΈ mainν΄λμ¤μ— `@EnableEncryptableProperties` μ–΄λ…Έν…μ΄μ… μ¶”κ°€

```java
@SpringBootApplication
@EnableEncryptableProperties
public class AirbnbApplication {
    public static void main(String[] args) {
        SpringApplication.run(AirbnbApplication.class, args);
    }
}
```





## [Spring] application.properties λ¶„λ¦¬ν•κΈ°

1. μ„¤μ • λ¶„λ¥λ€λ΅ `application-λ¶„λ¥.properties` νμΌμ„ `resource`ν¨ν‚¤μ§€μ— μ¶”κ°€ν•κ³  κ΄€λ ¨ μ„¤μ •μ„ ν•΄λ‹Ή νμΌλ΅ λ¶„λ¦¬ν•λ‹¤.
2. μ•„λ μ½”λ“λ¥Ό μ›λ `application.properties`νμΌμ— μ¶”κ°€ν•λ‹¤.

```
spring.profiles.include=λ¶„λ¥λ…1,λ¶„λ¥λ…2,λ¶„λ¥λ…3
```

μλ¥Ό λ“¤μ–΄ κΈ°μ΅΄ `application.properties` μ— ν•κΊΌλ²μ— λ“¤μ–΄ μλ jwt, oauth μ„¤μ •λ“¤μ„ λ¶„λ¦¬ν•κ³  μ‹¶μ„ λ•

1. jwt, oauth μ„¤μ •λ“¤μ„ κ°κ° `application-jwt.properties`, `application-oauth.properties` μΌλ΅ λ¶„λ¦¬
2. κΈ°μ΅΄ `application.properties`μ— `spring.profiles.include=jwt,oauth` μ¶”κ°€



## IPv4 CIDR μ½λ” λ²•(ipμ£Όμ† μ½λ” λ²•)

`0.0.0.0/0`

IPμ£Όμ†λ” 32λΉ„νΈλ΅ λμ–΄ μλ‹¤.

(`0.0.0.0` ~ `255.255.255.255`)

(= μ΄μ§„μλ΅ ν‘ν„ν•λ©΄ `11111111.11111111.11111111.11111111`μ΄κΈ° λ•λ¬Έμ— 32λΉ„νΈλΌκ³  ν•λ‹¤.)

- `/` μ™Όμ½μ μ«μ 
  - 4 μλ¦¬μ 1 μ«μκ°€ κ°κ° 8λΉ„νΈλ¥Ό μλ―Έν•¨ (2μ 3μΉ)
  - κ° μλ¦¬λ” 0λ¶€ν„° 255κΉμ§€μ μ«μ(256κ° = 2μ 8μΉ. κ·Έλμ„ 8λΉ„νΈ)λ¥Ό κ°€μ§ μ μλ‹¤.

- `/` μ΄ν•μ μ«μ  (μµλ€ 32 = 8λΉ„νΈ * 4)
  - = prefix. μ‚¬μ©ν•  IP μ£Όμ†μ—μ„ μ™Όμ½λ¶€ν„° nκ°μ κ³ μ • λ²”μ„λ¥Ό μ„¤μ •ν•  μ μλ‹¤
  - μλ¥Ό λ“¤μ–΄ `/16`μ΄λΌλ©΄ 'μ΄μ§„μ κΈ°μ¤€' μ™Όμ½μ—μ„ 16κ°μ μ«μλ“¤μ„ κ³ μ •ν•κ² λ‹¤λ” λ»μ΄λ‹¤. (`11111111.11111111.κ°€λ³€.κ°€λ³€`)


